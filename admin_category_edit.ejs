<%- include('../partials/head', { title }) %>
<%- include('../partials/nav', { user }) %>

<div class="container">
  <div class="row row--between row--center mt-24">
    <h2><%= title %></h2>
    <a class="btn btn--ghost" href="/admin/categories"><%= t('back') %></a>
  </div>

  <% if (ok) { %>
    <div class="alert alert--ok mt-16"><%= ok %></div>
  <% } %>
  <% if (err) { %>
    <div class="alert alert--danger mt-16"><%= err %></div>
  <% } %>

  <div class="card mt-16">
    <div class="card__body">
      <form method="post" enctype="multipart/form-data" action="<%= category.id ? ('/admin/categories/' + category.id) : '/admin/categories/new' %>">
        <div class="grid grid--2">
          <div>
            <label class="label"><%= t('title_fa') %></label>
            <input class="input" name="title" required value="<%= category.title || '' %>" placeholder="مثلاً: نوشیدنی‌های سرد" />
          </div>
          <div>
            <label class="label"><%= t('title_en') %></label>
            <input class="input" name="title_en" value="<%= category.title_en || '' %>" placeholder="e.g. Morning Rituals" />
          </div>
          <div>
            <label class="label"><%= t('sort_order') %> (عدد کوچکتر = بالاتر)</label>
            <input class="input" name="sort_order" type="number" value="<%= (category.sort_order ?? 10) %>" />
          </div>
<div>
  <label class="label">آیکن دسته (اختیاری)</label>
  <input class="input" type="file" name="icon" accept="image/*,.svg" />
  <% if (category.icon) { %>
    <div class="muted" style="margin-top:6px;font-size:12px;">آیکن فعلی:</div>
    <img src="<%= category.icon %>" alt="icon" style="max-height:48px;margin-top:6px;border-radius:10px;background:#fff;padding:6px;"/>
  <% } %>
</div>
        </div>

        <div class="row row--between mt-16">
          <button class="btn btn--primary" type="submit"><%= t('save') %></button>

          <% if (category.id) { %>
            <a class="btn btn--ghost" href="/admin/categories/<%= category.id %>">بازنشانی</a>
          <% } %>
        </div>
      </form>

      <% if (category.id) { %>
        <hr class="mt-16 mb-16" />
        <form method="post" action="/admin/categories/<%= category.id %>/delete" onsubmit="return confirm('حذف شود؟ اگر محصول دارد، حذف نمی‌شود.');">
          <button class="btn btn--danger" type="submit">حذف دسته‌بندی</button>
        </form>
      <% } %>

      <div class="muted mt-12">
        این بخش فقط برای مدیریت دسته‌بندی‌های منو است. محصولات را از «محصولات» مدیریت کنید.
      </div>
    </div>
  </div>
</div>

<%- include('../partials/foot') %>
